<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:ui="http://java.sun.com/jsf/facelets">

<ui:composition template="_template.xhtml">
	<ui:define name="corpo">
		<h2>Tabular Chamadas</h2>
		<h:form>
			<fieldset>
				<legend>Dados da Tabulação</legend>
					<h:panelGrid columns="2">	
							
					<h:outputLabel value="Data da Chamada:" for="dtChamada"/>
					<h:inputText id="dtChamada" value="#{tabulacaoBean.tabulacao.dataChamada.time}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/> 
					</h:inputText>
					
					<h:outputLabel value="Terminal:" for="terminal"/>
					<h:inputText id="terminal" value="#{tabulacaoBean.tabulacao.terminal}"/>
					
					<h:outputLabel value="Produto:" for="produto"/>
					<h:selectOneMenu id="produto" value="#{tabulacaoBean.produtoSelecionado}">
						<f:selectItem itemLabel="-- Selecione --" noSelectionOption="true"/>
						<f:selectItems value="#{produtoBean.produtos}" var="produto"
							itemValue="#{produto.id}" itemLabel="#{produto.nome}" />
						<f:ajax execute="@this" render="motivo"/>
					</h:selectOneMenu>
					
					<h:outputLabel value="Motivo:" for="motivo"/>
					<h:selectOneMenu id="motivo" value="#{tabulacaoBean.motivoSelecionado}">
						<f:selectItem itemLabel="-- Selecione --" noSelectionOption="true"/>
						<f:selectItems value="#{tabulacaoBean.motivos}" var="motivo"
							itemValue="#{motivo}" itemLabel="#{motivo}"/>
						<f:ajax excute="@this" render="submotivo"/>
					</h:selectOneMenu>
					
					<h:outputLabel value="Submotivo:" for="submotivo"/>
					<h:selectOneMenu id="submotivo" value="#{tabulacaoBean.subMotivoSelecionado}">
						<f:selectItem itemLabel="-- Selecione -- " noSelectionOption="true"/>
						<f:selectItems value="#{tabulacaoBean.subMotivos}" var="submotivo"
							itemValue="#{submotivo}" itemLabel="#{submotivo}" />
						<f:ajax execute="@this" render="detalhe"/>
					</h:selectOneMenu>
					
					<h:outputLabel value="Detalhe:" for="detalhe"/>
					<h:selectOneMenu id="detalhe" value="#{tabulacaoBean.detalheSelecionado}">
						<f:selectItem itemLabel="-- Selecione --" noSelectionOption="true"/>
						<f:selectItems value="#{tabulacaoBean.detalhes}" var="detalhe"
							itemValue="#{detalhe}" itemLabel="#{detalhe}" />
					</h:selectOneMenu>
					
					<h:outputLabel value="Descrição:" for="descricao"/>
					<h:inputTextarea id="descricao" value="#{tabulacaoBean.tabulacao.descricao}" rows="5" cols="35"/>
					
					<h:commandButton value="Tabular" action="#{tabulacaoBean.tabula}">
						<f:ajax execute="@form" render=":formTabela"/>
					</h:commandButton>
					
					<h:commandButton value="Limpar" action="#{tabulacaoBean.limpa}" >
						<f:ajax render="@form"/>
					</h:commandButton>
				</h:panelGrid>
			</fieldset>
		</h:form>
		
		<!-- TABELA DE TABULAÇÕES-->
		
		<h2>Tabulações</h2>
			
		<h:form id="formTabela">
			<h:dataTable value="#{tabulacaoBean.tabulacoes}" var="tabulacao"
				styleClass="dados" rowClasses="impar, par">
				<h:column>
					<f:facet name="header">Data da Chamada</f:facet>
					<h:outputText
						value="#{tabulacao.dataChamada.time}" >
						<f:convertDateTime pattern="dd/MM/yyyy"
							timeZone="America/Sao_Paulo" />
					</h:outputText>
				</h:column>
				
				<h:column>
					<f:facet name="header">Terminal</f:facet>
					#{tabulacao.terminal}
				</h:column>
				
				<h:column>
					<f:facet name="header">Produto</f:facet>
					#{tabulacao.produto}
				</h:column>
				
				<h:column>
					<f:facet name="header">Motivo</f:facet>
					#{tabulacao.motivo}
				</h:column>
				
				<h:column>
					<f:facet name="header">Submotivo</f:facet>
					#{tabulacao.submotivo}
				</h:column>
				
				<h:column>
					<f:facet name="header">Detalhe</f:facet>
					#{tabulacao.detalhe}
				</h:column>
				
				<h:column>
					<f:facet name="header">Descrição</f:facet>
					#{tabulacao.descricao}
				</h:column>
				
				<h:column>
					<f:facet name="header">Nome do Usuário</f:facet>
					#{tabulacao.nomeUsuario}
				</h:column>
				
				<h:column>
					<f:facet name="header">Data da Tabulacao</f:facet>
					<h:outputText
						value="#{tabulacao.dataTabulacao.time}" >
						<f:convertDateTime pattern="dd/MM/yyyy - HH:mm:ss"
							timeZone="America/Sao_Paulo" />
					</h:outputText>
				</h:column>
			</h:dataTable>
		</h:form>
	</ui:define>
</ui:composition>
</html>